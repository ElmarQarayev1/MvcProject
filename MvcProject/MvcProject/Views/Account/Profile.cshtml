@model ProfileEditViewModel
@{
    ViewData["Title"] = "Profile";
    int order = 0;
}
<div class="container mt-5">
    <h2 class="text-center">@ViewData["Title"]</h2>
    <form method="post" class="mt-4">
        <div class="card shadow-sm p-4">
            <div class="form-group row">
                <label for="first-name" class="col-sm-3 col-form-label">Full Name</label>
                <div class="col-sm-9">
                    <input asp-for="FullName" id="first-name" class="form-control" type="text">
                    <span class="text-danger" asp-validation-for="FullName"></span>
                </div>
            </div>
            <div class="form-group row">
                <label for="display-name" class="col-sm-3 col-form-label">User Name</label>
                <div class="col-sm-9">
                    <input asp-for="UserName" id="display-name" class="form-control" type="text">
                    <span class="text-danger" asp-validation-for="UserName"></span>
                </div>
            </div>
            <div class="form-group row">
                <label for="email" class="col-sm-3 col-form-label">Email Address</label>
                <div class="col-sm-9">
                    <input asp-for="Email" id="email" class="form-control" type="email">
                    <span class="text-danger" asp-validation-for="Email"></span>
                </div>
            </div>
            <h4 class="mt-4">Password Change</h4>
            <div class="form-group row">
                <label for="current-pwd" class="col-sm-3 col-form-label">Current Password</label>
                <div class="col-sm-9">
                    <input asp-for="CurrentPassword" id="current-pwd" class="form-control" type="password">
                    <span class="text-danger" asp-validation-for="CurrentPassword"></span>
                </div>
            </div>
            <div class="form-group row">
                <label for="new-pwd" class="col-sm-3 col-form-label">New Password</label>
                <div class="col-sm-9">
                    <input asp-for="NewPassword" id="new-pwd" class="form-control" type="password">
                    <span class="text-danger" asp-validation-for="NewPassword"></span>
                </div>
            </div>
            <div class="form-group row">
                <label for="confirm-pwd" class="col-sm-3 col-form-label">Confirm Password</label>
                <div class="col-sm-9">
                    <input asp-for="ConfirmNewPassword" id="confirm-pwd" class="form-control" type="password">
                    <span class="text-danger" asp-validation-for="ConfirmNewPassword"></span>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-9 offset-sm-3">
                    <div class="text-danger" asp-validation-summary="ModelOnly"></div>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-9 offset-sm-3">
                    <button type="submit" class="btn btn-success">Save Changes</button>
                </div>
            </div>
        </div>
    </form>

    <div id="statusDiv" style=" margin-left:700px;  margin-bottom:70px; padding-top:70px; width: 400px; background-color: orange; padding: 10px; text-align: center; display:none;"></div>

    <div class="myaccount-content mt-5">
        <h3>Orders</h3>
        <div class="table-responsive">
            <table class="table table-bordered table-striped text-center">

                <thead class="thead-light">
                    <tr>
                        <th>No</th>
                        <th>Date</th>
                        <th>CourseName</th> 
                        <th>Status</th>
                        <th>Price</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Applications)
                    {
                        order++;
                        <tr>
                            <td>@order</td>
                            <td>@(item.CreatedAt.ToString("yyyy-MM-dd hh:mm"))</td>
                            <td>@item.Course.Name</td>
                            <td>@item.Status</td>
                            <td>$@item.Course.Price</td>
                            <td>
                                @if (item.Status == MvcProject.Models.Enum.ApplicationStatus.Pending)
                                {
                                    <a href="@Url.Action("cancel", "application", new { id = item.Id })" class="btn btn-danger btn-sm">Cancel</a>
                                }
                            </td>
                        </tr>
                    }

                    <tr>
                        <td colspan="4"></td>
                        <td>Total Price:</td>
                        <td>$@Model.Applications.Sum(a => a.Course.Price)</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-KyZXEAg3QhqLMpG8r+Knujsl5/1hb/4XDsl1pY4KKllEQO5Fh5YLP+X86p98/UqIbYLLiE2Npbb3PUlV4F1w3A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.0/signalr.js" integrity="sha512-pn4yorWMbHHvdsldBpkTNjJaoadsoYs/ZgOYHSHUtivn1j/Ddgdnlgt1egjQcP8j4atM3TR+tgIqgjhi5Z11KQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.0/signalr.min.js" integrity="sha512-7rhBJh1om/W5Ztx7WiYOR9h2wlSaTmPyQMoHFtbT/FVNIA12y6S6I8HY9mrBS1uJ3dSU/R3qaSAXsGYuRjMDxg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    var connection = new signalR.HubConnectionBuilder()
        .withUrl("/hub")
        .build();

    connection.on("ShowNotification", function (status) {
       
        document.getElementById("statusDiv").innerText = "Your apply status: " + status;
        
        document.getElementById("statusDiv").style.display = "block";
       
        setTimeout(function () {
            document.getElementById("statusDiv").style.display = "none";
        }, 8000); 
    });
    connection.start().catch(function (err) {
        console.error(err.toString());
    });
    </script>